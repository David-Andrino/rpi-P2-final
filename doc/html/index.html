<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Embedded System Design Project: Raspberry Pi Embedded Project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Embedded System Design Project
   &#160;<span id="projectnumber">v1.0.0</span>
   </div>
   <div id="projectbrief">Embedded System Design Project for color and acceleration sensing on a Raspberry Pi with a custom embedded OS. Made by David Andrino and Fernando Sanz</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Raspberry Pi Embedded Project </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Project for the Embedded System Design with Raspberry Pi subject in the 2022/23 course. Made by David Andrino and Fernando Sanz.</p>
<p>Multi-threaded application that uses I2C to communicate with the TCS3462 color sensor and displays its measurements to the user through a terminal. It allows the user to select different color measurement calculations such as IR reject, clear compensation, etc.</p>
<h2>Usage</h2>
<p>TODO: Add usage and images about the application</p>
<h2>Build from Source</h2>
<p>To use this application you have to clone the repository, compile it with a cross-compiling tool and update to the Raspberry Pi. You need a compiler created with the same Buildroot configuration that was used to generate the Raspberry Pi's embedded operating system.</p>
<div class="fragment"><div class="line">git clone https://github.com/SoraSpades/rpi-P2-final/ &amp;&amp; \</div><div class="line">cd rpi-P2-final/ &amp;&amp; \</div><div class="line">make &amp;&amp; \</div><div class="line">scp ./main root@&lt;raspberry pi&#39;s IP&gt;:.</div></div><!-- fragment --><p>After the execution of that command, the application can be found inside the home folder of the root user in the Raspberry Pi.</p>
<p>The usage of this application depends on the availability of the I2C virtual device inside the <code>/dev</code> folder in the Raspberry Pi. If it is missing, two things must be done:</p><ol type="1">
<li>Add the following lines to the <code>config.txt</code> file inside the boot partition of the SD card: <div class="fragment"><div class="line">dtparam=i2c_arm=on</div><div class="line">dtparam=i2c1=on</div></div><!-- fragment --></li>
<li>Create a file called <code>S60i2c</code> inside the <code>/etc/init.d/</code> folder in the Raspberry Pi with the following content and make it executable (<code>chmod +x /etc/init.d/S60i2c</code>): <div class="fragment"><div class="line">#!/bin/sh</div><div class="line">modprobe i2c-bcm2835</div><div class="line">modprobe i2c-dev</div></div><!-- fragment --></li>
</ol>
<h2>Download Release</h2>
<p>You can download an alredy compiled version in the <a href="https://github.com/SoraSpades/rpi-P2-final/releases">Releases</a> tab. It, however, will only work in a Raspberry Pi with an embedded operating system compiled with buildroot with the same parameters as in the classes and it needs i2c enabled. Download the executable and copy it with an app like <code>scp</code> or <code>sftp</code>.</p>
<h2>Main Features</h2>
<ul>
<li>Interactive UI</li>
<li>Multiple threads in Producer-Consumer model</li>
<li>Use of 4 threads to accomodate to the 4 cores of the Raspberry</li>
<li>Code checked with cppcheck for possible memory leaks</li>
<li>Compliant to Embedded C Standard (check sources)</li>
<li>Configurable color sensing</li>
</ul>
<h2>Sources</h2>
<ul>
<li><a href="https://invensense.tdk.com/wp-content/uploads/2015/02/MPU-6000-Register-Map1.pdf">MPU-6000 and MPU-6050 Register Map and Descriptions</a></li>
<li><a href="https://invensense.tdk.com/wp-content/uploads/2015/02/MPU-6000-Datasheet1.pdf">MPU-6000 and MPU-6050 Product Specification</a></li>
<li><a href="https://cdn-shop.adafruit.com/datasheets/TCS34725.pdf">TCS3472 Datasheet</a></li>
<li><a href="https://github.com/adafruit/Adafruit_TCS34725">Adafruit's Color Sensor Library for Arduino</a></li>
<li><a href="https://www.cs.cmu.edu/afs/cs/academic/class/15492-f07/www/pthreads.html">POSIX thread (pthread) libraries</a></li>
<li><a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_lock.html">POSIX mutex specification</a></li>
<li><a href="https://barrgroup.com/embedded-systems/books/embedded-c-coding-standard">Embedded C Coding Standard</a></li>
<li><a href="https://books.google.es/books?id=T0JRAgAAQBAJ&amp;printsec=frontcover&amp;hl=es#v=onepage&amp;q&amp;f=false">Raspberry Pi Cookbook</a></li>
<li><a href="https://www.mankier.com/package/i2c-tools">I2C-tools Wiki</a></li>
<li><a href="https://stackoverflow.com/questions/52975817/setup-i2c-reading-and-writing-in-c-language">StackOverflow question regarding i2c</a></li>
<li><a href="https://openest.io/en/services/activate-raspberry-pi-4-i2c-bus/">How to activate Raspberry-piâ€™s i2c bus</a></li>
<li><a href="https://www.doxygen.nl/index.html">Doxygen</a> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
